-- Создание табблицы
create table book (
    book_id	INT PRIMARY KEY AUTO_INCREMENT,
    title	VARCHAR(50),
    author	VARCHAR(30),
    price	DECIMAL(8, 2),
    amount	INT
);

-- Заполнение таблицы значениями
insert into book (title, author, price, amount) values ("Мастер и Маргарита", "Булгаков М.А.", 670.99, 3);
insert into book (title, author, price, amount) values ("Белая гвардия", "Булгаков М.А.", 540.50, 5);
insert into book (title, author, price, amount) values ("Идиот", "Достоевский Ф.М.", 460.00, 10);
insert into book (title, author, price, amount) values ("Братья Карамазовы", "Достоевский Ф.М.", 799.01, 2);
insert into  book (title, author, price, amount) values ("Черный человек','Есенин С.А.", Null, Null);
insert into book (title, author, price, amount) values ("Стихотворения и поэмы", "Есенин С.А.", 650.00, 15);
insert into book (title, author, price, amount) values ("Игрок", "Достоевский Ф.М.", 480.50, 10);

-- Выбор всех данных из таблицы
select * from book;

-- Выборка отдельных столбцов
select author, title, price from book;

-- Выборка новых столбцов и присвоение им новых имен
select title as Название, author as Автор from book;

-- Выборка данных с созданием вычисляемого столбца
select title, amount, amount * 1.65 as pack from book;

-- Выборка данных, вычисляемые столбцы, математические функции
select title, author, amount, ROUND((price - price*0.3), 2) as new_price from book;
select author, title, ROUND (IF(author = "Булгаков М.А.", price + price * 0.1, IF(author = "Есенин С.А.", price + price * 0.05, price)), 2) as new_price from book;

-- Выборка данных по условию
select author, title, price from book where amount < 10;

-- Выборка данных, логические операции
select title, author, price, amount from book where (price < 500 or price > 600) and amount * price >= 5000 ;

-- Выборка данных, операторы BETWEEN, IN
select title, author from book where (price between 540.50 and 800) and amount in (2, 3, 5, 7);

-- Выборка данных с сортировкой
select author, title from book where (amount between 2 and 14) order by author desc, title asc;

-- Выборка данных, оператор LIKE
select title, author from book where title like "%_% %_%" and author like "%С.%" order by title;

-- Выбор уникальных элементов столбца
select distinct amount from book;

-- Выборка данных, групповые функции SUM и COUNT
select author, count(title) as Разлтчных_книг, sum(amount) as Количество_экзепляров from book group by author;

-- Выборка данных, групповые функции MIN, MAX и AVG
select author, min(price) as Минимальная_цена, max(price) as Максимальная_цена, avg(price) as Средняя_цена from book group by author;

-- Выборка данных c вычислением, групповые функции
select author, round(sum(amount * price), 2) as Стоимость, round(sum(((price * amount * (18/100))/(1 + 18/100))), 2) as НДС, round(sum((price * amount)/(1 + (18/100))), 2) as Стоимость_без_НДС from book group by author;

-- Вычисления по таблице целиком
select min(price) as Минимаьная_цена, max(price) as Максимальная_цена, round((avg(price)),2) as Средняя_цена from book;

-- Выборка данных по условию, групповые функции
select round(avg(price), 2) as Средняя_цена, round(sum(price * amount), 2) as Стоимость from book where amount between 5 and 14;